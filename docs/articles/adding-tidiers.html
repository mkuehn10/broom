<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding tidiers to broom • broom</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- tidyverse --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">broom</a>
        <small class="tidyverse">part of the <a href="https://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/broom.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adding-tidiers.html">Adding new tidiers</a>
    </li>
    <li>
      <a href="../articles/available-methods.html">Available methods</a>
    </li>
    <li>
      <a href="../articles/bootstrapping.html">Bootstrapping</a>
    </li>
    <li>
      <a href="../articles/broom_and_dplyr.html">Broom and dplyr</a>
    </li>
    <li>
      <a href="../articles/external-tidiers.html">Tidiers in external packages</a>
    </li>
    <li>
      <a href="../articles/kmeans.html">K-means</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/broom">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adding tidiers to broom</h1>
            
            <h4 class="date">2018-08-07</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/tidymodels/broom/blob/master/vignettes/adding-tidiers.Rmd"><code>vignettes/adding-tidiers.Rmd</code></a></small>
      <div class="hidden name"><code>adding-tidiers.Rmd</code></div>

    </div>

    
    
<div id="adding-new-tidiers-to-broom" class="section level1">
<h1 class="hasAnchor">
<a href="#adding-new-tidiers-to-broom" class="anchor"></a>Adding new tidiers to broom</h1>
<p>Thank you for your interest in contributing to broom! This document describes the conventions that you should follow when adding tidiers to broom.</p>
<p>General guidelines:</p>
<ul>
<li>Reach a minimum 90% test coverage for new tidiers. To check your test coverage we recommend using <code><a href="http://www.rdocumentation.org/packages/covr/topics/report">covr::report()</a></code>.</li>
<li>
<code>tidy</code>, <code>glance</code> and <code>augment</code> methods <strong>must</strong> return tibbles.</li>
<li>Update <code>NEWS.md</code> to reflect the changes you’ve made</li>
<li>Follow the <a href="http://style.tidyverse.org/">tidyverse style conventions</a>. You can use the <a href="https://github.com/r-lib/styler"><code>styler</code></a> package to reformat your code according to these conventions, and the <a href="https://github.com/jimhester/lintr"><code>lintr</code></a> package to check that your code meets the conventions.</li>
<li>Use new tidyverse packages such as <code>dplyr</code> and <code>tidyr</code> over older packages such as <code>plyr</code> and <code>reshape2</code>.</li>
<li>It’s better to have a predictable number of columns and unknown number rows than an unknown number of columns and a predictable number of rows.</li>
<li>It’s better for users to need to <code><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">tidyr::spread</a></code>than <code><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">tidyr::gather</a></code> data after it’s been tidied.</li>
<li>Add yourself as a contributor to <code>DESCRIPTION</code>.</li>
<li>Pull requests must pass the AppVeyor and Travis CI builds to be merged.</li>
<li>Check that your PR contains a big picture summary of what you’ve done</li>
<li>Include an example that demonstrates the new behavior implemented in your PR</li>
<li>When in doubt, please reach out to the maintainers. We are happy to help with any questions.</li>
</ul>
<p>If you are just getting into open source development, <code>broom</code> is an excellent place to get started and we are more than happy to help. We recommend you start contributing by improving the documentation, writing issues with reproducible errors, or taking on issues tagged <code>beginner-friendly</code>.</p>
<div id="which-package-does-my-tidier-belong-in" class="section level2">
<h2 class="hasAnchor">
<a href="#which-package-does-my-tidier-belong-in" class="anchor"></a>Which package does my tidier belong in?</h2>
<p>Ideally, tidying methods should live in the packages of their associated modelling functions. That is, if you have some object <code>my_object</code> produced by<code>my_package</code>, the functions <code>tidy.my_object</code>, <code>glance.my_object</code> and <code>augment.my_object</code> should live in <code>my_package</code>, provided there are sensible ways to define these tidiers for <code>my_object</code>. For guidance on writing tidiers that live in external packages, please see <code><a href="../articles/external-tidiers.html">vignette("external-tidiers")</a></code>.</p>
<p>We are currently working on an appropriate way to split tidiers into several domain specific tidying packages. For now, if you don’t own <code>my_package</code>, you should add the tidiers to <code>broom</code>. There are some exceptions:</p>
<ul>
<li>Mixed model tidiers belong in <a href="https://github.com/bbolker/broom.mixed"><code>broom.mixed</code></a>
</li>
<li>Natural language related tidiers belong in <a href="https://github.com/juliasilge/tidytext"><code>tidytext</code></a>
</li>
<li>Tree tidiers belong in <a href="https://github.com/njtierney/broomstick"><code>broomstick</code></a>
</li>
<li>Tidiers for objects from BioConductor belong in <a href="https://bioconductor.org/packages/release/bioc/html/biobroom.html"><code>biobroom</code></a>
</li>
</ul>
<p>We will keep you updated as we work towards a final solution.</p>
</div>
</div>
<div id="implementing-new-tiders" class="section level1">
<h1 class="hasAnchor">
<a href="#implementing-new-tiders" class="anchor"></a>Implementing new tiders</h1>
<p>We encourage you to develop new tidiers using your favorite tidyverse tools. Pipes are welcome, as is any code that you might write for tidyverse-style interactive data manipulation.</p>
<p>If you are implementing a new tidier, we recommend taking a look at the internals of the tidying methods for <code>betareg</code> and <code>rq</code> objects and using those as a starting point.</p>
<p>You should also be aware of the following helper functions:</p>
<ul>
<li>
<code>as_broom_tibble()</code> (this is a newer implementation of <code><a href="../reference/fix_data_frame.html">fix_data_frame()</a></code>)</li>
<li><code><a href="../reference/finish_glance.html">finish_glance()</a></code></li>
<li>
<code>augment_newdata()</code> (this is a newer implementation of <code><a href="../reference/augment_columns.html">augment_columns()</a></code>)</li>
</ul>
</div>
<div id="documenting-new-tidiers" class="section level1">
<h1 class="hasAnchor">
<a href="#documenting-new-tidiers" class="anchor"></a>Documenting new tidiers</h1>
<p>All new tidiers should be fully documented following the <a href="http://style.tidyverse.org/">tidyverse code documentation guidelines</a>. Documentation should use full sentences with appropriate punctation. Documentation should also contain at least one but potentially several examples of how the tidiers can be used. Documentation should be written in R markdown as much as possible.</p>
<p>Many behaviors in broom are quite repetitive. We have tried to automate the documentation process as much as possible to keep documentation as consistent as possible across the package. Beyond the standard <code>roxygen2</code> tags, we also make extensive use of the <code>@template</code> tag.</p>
<p>We recommend emulating the style in the <code>betareg</code> tidiers as much as possible.</p>
<p>If you implement <code>tidy.my_object()</code>, <code>glance.my_object()</code> and <code>augment.my_object()</code>, each method should be documented separately. Treat the tidy method as the default method that the user will read first. We commonly write the examples for all tidying methods in the <code><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">tidy()</a></code> documentation, and then use <code>@inherit tidy.my_object examples</code> in the other tidying methods.</p>
<p>By such to link methods together using the <code>@family</code> tag. We strongly encourage heavy cross-referencing in the documentation.</p>
<p>Lastly, we have a slightly non-standard approach to documenting function returns. In particular, we almost never use <code>@return</code> and prefer <code>@evalRd return_tidy()</code> (or <code>@evalRd return_glance()</code> for glance methods, and <code>@evalRd return_augment()</code> and so on). Never use <code>@evalRd</code> alongside <code>@return</code>. Additionally note that <code>@evalRd</code> does not support Markdown documentation at this time.</p>
<p>Using <code>@evalRd return_tidy("column_name")</code> will automatically pull the documentation for <code>column_name</code> from the column glossary in <a href="https://github.com/alexpghayes/modeltests"><code>modeltests</code></a>. This allows use to consistently describe columns that are used many time throughout broom. If you need to define a new column, you do so inline:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#' @evalRd return_tidy(my_new_column = "Description of the column goes here")</span></code></pre></div>
<p>Column names that will be used be many models (for example, “AIC” or “BIC”) should be defined in the column glossary in <code>modeltests</code> via a pull request. Please read the documentation for <code>return_tidy()</code>, <code>return_glance()</code> and <code>return_augment()</code>.</p>
</div>
<div id="testing-new-tidiers" class="section level1">
<h1 class="hasAnchor">
<a href="#testing-new-tidiers" class="anchor"></a>Testing new tidiers</h1>
<p>Any changes that you make will need to pass the existing tests. The tests can be run with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/test">test</a></span>()</code></pre></div>
<p>Your changes should also pass R CMD Check, which can be run with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/check">check</a></span>()</code></pre></div>
<p>We recommend testing broom locally with R 3.5.0 or later. To test earlier versions of R, you’ll need to see the environment variable <code>R_MAX_NUM_DLLS</code> to 250.</p>
<p>Note that testing broom requires a lot of packages. You can install them all with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"tidymodels/broom"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div id="file-naming" class="section level2">
<h2 class="hasAnchor">
<a href="#file-naming" class="anchor"></a>File naming</h2>
<p>If you are only tidying a single class from a package and have fewer than 300 or so lines of code, please put your tidiers in a file <code>R/&lt;package&gt;-tidiers.R</code>. If you are adding multiple tidiers from the same package, they should live in <code>R/&lt;package&gt;-&lt;class&gt;-tidiers.R</code>.</p>
<p>The corresponding tests should have the same prefix, and should live in <code>tests/testthat/</code>. For example: <code>tests/testthat/test-&lt;package&gt;.R</code> or <code>tests/testthat/test-&lt;package&gt;-&lt;class&gt;.R</code>.</p>
</div>
<div id="tests-for-new-tidiers" class="section level2">
<h2 class="hasAnchor">
<a href="#tests-for-new-tidiers" class="anchor"></a>Tests for new tidiers</h2>
<p>Again we recommend following the basic outline of the betareg tests. At a minimum new tests should include</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">context</span>(<span class="st">"myobj"</span>)

<span class="kw">skip_if_not_installed</span>(<span class="st">"modeltests"</span>)
<span class="kw">library</span>(modeltests)

<span class="co"># be sure you've added any package your tidying methods depend on to Suggests</span>
<span class="co"># you can do so with:</span>
<span class="co">#   usethis::use_package("mypkg", type = "Suggests")</span>
<span class="kw">skip_if_not_installed</span>(<span class="st">"mypkg"</span>)
<span class="kw">library</span>(mypkg)

fit1 &lt;-<span class="st"> </span><span class="kw">myobj</span>(...)
fit2 &lt;-<span class="st"> </span><span class="kw">myobj</span>(..., <span class="dt">option =</span> <span class="st">"something different"</span>)

<span class="kw">test_that</span>(<span class="st">"myobj tidier arguments"</span>, {
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_arguments">check_arguments</a></span>(tidy.myobj)
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_arguments">check_arguments</a></span>(glance.myobj)
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_arguments">check_arguments</a></span>(augment.myobj)
})

<span class="kw">test_that</span>(<span class="st">"tidy.myobj"</span>, {
  
  td1 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">tidy</a></span>(fit1)
  td2 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">tidy</a></span>(fit2, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>, <span class="dt">option =</span> <span class="st">"another case"</span>)
  
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_tidy_output">check_tidy_output</a></span>(td1)
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_tidy_output">check_tidy_output</a></span>(td2)
  
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_dims">check_dims</a></span>(td1, <span class="dv">12</span>, <span class="dv">8</span>)  <span class="co"># optional but a good idea</span>
})

<span class="kw">test_that</span>(<span class="st">"glance.myobj"</span>, {
  
  gl1 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">glance</a></span>(fit1)
  gl2 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">glance</a></span>(fit2)
  
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_glance_outputs">check_glance_outputs</a></span>(gl1, gl2)
})

<span class="kw">test_that</span>(<span class="st">"augment.myobj"</span>, {
  
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_augment_function">check_augment_function</a></span>(
    augment.myobj,           <span class="co"># *must* pass the specific method here</span>
    fit1,
    <span class="dt">data =</span> mydata,
    <span class="dt">newdata =</span> mydata
  )
  
  <span class="kw"><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_augment_function">check_augment_function</a></span>(
    augment.myobj,
    fit2,
    <span class="dt">data =</span> mydata2,
    <span class="dt">newdata =</span> mydata2
  )
})</code></pre></div>
<p>For details on what gets tests, see <code><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_tidy_output">modeltests::check_tidy_output()</a></code>, <code><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_glance_outputs">modeltests::check_glance_outputs()</a></code> and <code><a href="http://www.rdocumentation.org/packages/modeltests/topics/check_augment_function">modeltests::check_augment_function()</a></code>.</p>
<p>These <strong>do not</strong> check for correctness. They only check for behavioral consistency with the rest of broom. You also need to write tests to check that your logic is correct and the values returned by the tidiers are the values you expect.</p>
<p>If you find a bug in the <code>check_*</code> function, please <a href="https://github.com/alexpghayes/modeltests/issues">open an issue in modeltests</a>, or even better, a PR.</p>
<p>In some cases the tests may simply not be appropriate for your methods. In this case you can set <code>strict = FALSE</code>. Be sure to document which tests fail when <code>strict = TRUE</code> and why this is acceptable. You’ll also want to mention this in the body of your pull request.</p>
<div id="testing-miscellenea" class="section level3">
<h3 class="hasAnchor">
<a href="#testing-miscellenea" class="anchor"></a>Testing miscellenea</h3>
<ul>
<li>If any of your tests use random number generation, you should call <code>set.seed()</code> in the body of the test.</li>
<li>We prefer informative errors to magical behaviors or untested success.</li>
</ul>
</div>
</div>
<div id="catching-edge-cases" class="section level2">
<h2 class="hasAnchor">
<a href="#catching-edge-cases" class="anchor"></a>Catching edge cases</h2>
<p>You should test new tidiers on a representative set of <code>my_object</code> objects. At a minimum, you should have a test for each distinct type of fit that appears in the examples for a particular model (if we working with <code><a href="http://www.rdocumentation.org/packages/stats/topics/arima">stats::arima</a></code> models, the tidiers should work for seasonal and non-seasonal models).</p>
<p>It’s important to test your tidiers for fits estimated with different algorithms (i.e. <code><a href="http://www.rdocumentation.org/packages/stats/topics/arima">stats::arima</a></code> tidier should be tested for <code>method = "CSS-ML"</code>, <code>method = "ML"</code> and <code>method = "ML"</code>). As another example, good tests for <code>glm</code> tidying methods would test tidiers on <code>glm</code> objects fit for all acceptable values of <code>family</code>.</p>
<p>In short: be sure that you’ve tested your tidiers on models fit with all the major modelling options (both statistical options, and estimation options).</p>
</div>
</div>
<div id="defining-tidiers" class="section level1">
<h1 class="hasAnchor">
<a href="#defining-tidiers" class="anchor"></a>Defining tidiers</h1>
<p>The big picture:</p>
<ul>
<li>
<code>glance</code> should provide a summary of <strong>model-level</strong> information as a <code>tibble</code> with <strong>exactly one row</strong>. This includes goodness of fit measures such as deviance, AIC, BIC, etc.</li>
<li>
<code>augment</code> should provide a summary of <strong>observation-level</strong> information as a <code>tibble</code> with <strong>one row per observation</strong>. This summary should preserve the observations. Additional information might include leverage, cluster assignments or fitted values.</li>
<li>
<code>tidy</code> should provide a summary of <strong>component-level</strong> information as a <code>tibble</code> with <strong>one row for each model component</strong>. Examples of model components include: regression coefficients, cluster centers, etc.</li>
</ul>
<p>Oftentimes it doesn’t make sense to define one or more of these methods for a particular model. In this case, just implement the methods that do make sense.</p>
<div id="glance" class="section level2">
<h2 class="hasAnchor">
<a href="#glance" class="anchor"></a><code>glance</code>
</h2>
<p>The <code><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">glance(x, ...)</a></code> method accepts a model object <code>x</code> and returns a tibble with exactly one row containing model level summary information.</p>
<ul>
<li><p>Output should not include the name of the modelling function or any arguments given to the modelling function. For example, <code><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">glance(glm_object)</a></code> does not contain a <code>family</code> column.</p></li>
<li><p>In some cases, you may wish to provide model level diagnostics not returned by the original object. If these are easy to compute, feel free to add them. However, <code>broom</code> is not an appropriate place to implement complex or time consuming calculations.</p></li>
<li><p><code>glance</code> should always return the same columns in the same order for an object <code>x</code> of class <code>my_object</code>. If a summary metric such as <code>AIC</code> is not defined in certain circumstances, use <code>NA</code>.</p></li>
</ul>
</div>
<div id="augment" class="section level2">
<h2 class="hasAnchor">
<a href="#augment" class="anchor"></a><code>augment</code>
</h2>
<p>The <code><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">augment(x, data = NULL, ...)</a></code> method accepts a model object and optionally a data frame <code>data</code> and adds columns of observation level information to <code>data</code>. <code>augment</code> returns a <code>tibble</code> with the same number of rows as <code>data</code>.</p>
<p>The <code>data</code> argument can be any of the following:</p>
<ul>
<li>a <code>data.frame</code> containing both the original predictors and the original responses</li>
<li>a <code>tibble</code> containing both the the original predictors and the original responses</li>
<li>if not <code>data</code> argument is specified, <code>augment</code> should try to reconstruct the original data as much as possible from the model object. This may not always be possible, and often it will not be possible to recover columns not used by the model.</li>
</ul>
<p>Any other inputs should result in an error.</p>
<p>Many <code>augment</code> methods will also provide an optional <code>newdata</code> argument that should also default to <code>NULL</code>. <code>newdata</code> should always precedence over <code>data</code> (you can check if <code>newdata</code> has been specified by checking whether not <code>newdata</code> still has the default <code>NULL</code> value).</p>
<p>Data given to the <code>data</code> argument must have both the original predictors and the original response. Data given to the <code>newdata</code> argument only needs to have the original predictors. This is important because there may be important information associated with training data that is not associated with test data, for example, leverages (<code>.hat</code> below) in the case in linear regression:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(speed <span class="op">~</span><span class="st"> </span>dist, <span class="dt">data =</span> cars)
<span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">augment</a></span>(model, <span class="dt">data =</span> cars)
<span class="co">#&gt; # A tibble: 50 x 9</span>
<span class="co">#&gt;    speed  dist .fitted .se.fit  .resid   .hat .sigma   .cooksd .std.resid</span>
<span class="co">#&gt;  * &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1     4     2    8.62   0.844 -4.62   0.0716   3.11 0.0888       -1.52  </span>
<span class="co">#&gt;  2     4    10    9.94   0.729 -5.94   0.0534   3.06 0.106        -1.93  </span>
<span class="co">#&gt;  3     7     4    8.95   0.815 -1.95   0.0667   3.18 0.0146       -0.638 </span>
<span class="co">#&gt;  4     7    22   11.9    0.578 -4.93   0.0335   3.10 0.0437       -1.59  </span>
<span class="co">#&gt;  5     8    16   10.9    0.650 -2.93   0.0424   3.16 0.0200       -0.950 </span>
<span class="co">#&gt;  6     9    10    9.94   0.729 -0.940  0.0534   3.19 0.00264      -0.306 </span>
<span class="co">#&gt;  7    10    18   11.3    0.625 -1.26   0.0392   3.18 0.00340      -0.409 </span>
<span class="co">#&gt;  8    10    26   12.6    0.536 -2.59   0.0289   3.17 0.0103       -0.832 </span>
<span class="co">#&gt;  9    10    34   13.9    0.473 -3.91   0.0225   3.14 0.0181       -1.25  </span>
<span class="co">#&gt; 10    11    17   11.1    0.637 -0.0986 0.0407   3.19 0.0000216    -0.0319</span>
<span class="co">#&gt; # ... with 40 more rows</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">augment</a></span>(model, <span class="dt">newdata =</span> cars)
<span class="co">#&gt; # A tibble: 50 x 4</span>
<span class="co">#&gt;    speed  dist .fitted .se.fit</span>
<span class="co">#&gt;  * &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1     4     2    8.62   0.844</span>
<span class="co">#&gt;  2     4    10    9.94   0.729</span>
<span class="co">#&gt;  3     7     4    8.95   0.815</span>
<span class="co">#&gt;  4     7    22   11.9    0.578</span>
<span class="co">#&gt;  5     8    16   10.9    0.650</span>
<span class="co">#&gt;  6     9    10    9.94   0.729</span>
<span class="co">#&gt;  7    10    18   11.3    0.625</span>
<span class="co">#&gt;  8    10    26   12.6    0.536</span>
<span class="co">#&gt;  9    10    34   13.9    0.473</span>
<span class="co">#&gt; 10    11    17   11.1    0.637</span>
<span class="co">#&gt; # ... with 40 more rows</span></code></pre></div>
<p>This means that many <code><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">augment(model, data = original_data)</a></code> should provide <code>.fitted</code> and <code>.resid</code> columns in most cases. <code><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">augment(model, data = test_data)</a></code> only needs to add a <code>.fitted</code> column, but if you can add <code>.resid</code> column we when the response is present in <code>test_data</code>, we encourage it.</p>
<p>If the <code>data</code> or <code>newdata</code> is specified as a <code>data.frame</code> with rownames, <code>augment</code> should return them in a column called <code>.rownames</code>. Use the helper <code>as_broom_tibble()</code> for this.</p>
<p>For observations where no fitted values or summaries are available (where there’s missing data, for example) return <code>NA</code>. Rows with missing data should never silently disappear. That is <code>nrow(input)</code> should equal <code>nrow(output)</code> with rare exceptions.</p>
<p>Added column names should begin with <code>.</code> to avoid overwriting columns in the original data.</p>
<p>Please do not use <code><a href="../reference/augment_columns.html">augment_columns()</a></code>, which we are slowly phasing out.</p>
</div>
<div id="tidy" class="section level2">
<h2 class="hasAnchor">
<a href="#tidy" class="anchor"></a><code>tidy</code>
</h2>
<p>The <code><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">tidy(x, ...)</a></code> method accepts a model object <code>x</code> and returns a tibble with one row per model component. A model component might be a single term in a regression, a single test, or one cluster/class. Exactly what a component is varies across models but is usually self-evident.</p>
<p>Sometimes a model will have different types of components. For example, in mixed models, there is different information associated with fixed effects and random effects, since this information doesn’t have the same interpretation, it doesn’t make sense to summarize the fixed and random effects in the same table. In cases like this you should add an argument that allows the user to specify which type of information they want. For example, you might implement an interface along the lines of:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">mixed_model</span>(...)
<span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">tidy</a></span>(model, <span class="dt">effects =</span> <span class="st">"fixed"</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/modelgenerics/topics/generics">tidy</a></span>(model, <span class="dt">effects =</span> <span class="st">"random"</span>)</code></pre></div>
<p><strong>Common arguments to tidy methods</strong>:</p>
<ul>
<li>
<code>conf.int</code>: Logical indicating whether or not to calculate confidence/credible intervals. Should default to <code>FALSE</code>.</li>
<li>
<code>conf.level</code>: The confidence level to use for the interval when <code>conf.int = TRUE</code>. If a tidying has a <code>conf.level</code> argument it must have a <code>conf.int</code> argument.</li>
<li>
<code>exponentiate</code>: Logical indicating whether or not model terms should be presented on an exponential scale (typical for logistic regression).</li>
<li>
<code>quick</code>: Logical indicating whether to use a faster <code>tidy</code> method that returns less information about each component, typically only <code>term</code> and <code>estimate</code> columns.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#adding-new-tidiers-to-broom">Adding new tidiers to broom</a><ul class="nav nav-pills nav-stacked">
<li><a href="#which-package-does-my-tidier-belong-in">Which package does my tidier belong in?</a></li>
      </ul>
</li>
      <li><a href="#implementing-new-tiders">Implementing new tiders</a></li>
      <li><a href="#documenting-new-tidiers">Documenting new tidiers</a></li>
      <li>
<a href="#testing-new-tidiers">Testing new tidiers</a><ul class="nav nav-pills nav-stacked">
<li><a href="#file-naming">File naming</a></li>
      <li><a href="#tests-for-new-tidiers">Tests for new tidiers</a></li>
      <li><a href="#catching-edge-cases">Catching edge cases</a></li>
      </ul>
</li>
      <li>
<a href="#defining-tidiers">Defining tidiers</a><ul class="nav nav-pills nav-stacked">
<li><a href="#glance"><code>glance</code></a></li>
      <li><a href="#augment"><code>augment</code></a></li>
      <li><a href="#tidy"><code>tidy</code></a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="tidyverse">
  <p>broom is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by David Robinson, Alex Hayes.</p>
  <p>Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.</p>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-115082821-1');
</script></footer>
</div>

  

  </body>
</html>
